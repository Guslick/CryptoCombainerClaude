# üõ°Ô∏è –°–ò–°–¢–ï–ú–ê –ù–ê–î–Å–ñ–ù–û–ô –û–ë–†–ê–ë–û–¢–ö–ò –û–®–ò–ë–û–ö

## üìã –û–±–∑–æ—Ä

–ü—Ä–æ–≤–µ–¥—ë–Ω –ø–æ–ª–Ω—ã–π —Ä–µ–≤—å—é –∫–æ–¥–∞ –∏ —Å–æ–∑–¥–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞, –∫–æ—Ç–æ—Ä–∞—è **–≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç**, —á—Ç–æ –ø—Ä–æ–≥—Ä–∞–º–º–∞:
1. ‚úÖ **–ù–µ –≤—ã–ª–µ—Ç–∏—Ç** –∏–∑-–∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π
2. ‚úÖ **–ü–æ–ø—ã—Ç–∞–µ—Ç—Å—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è** –ø–æ—Å–ª–µ –æ—à–∏–±–æ–∫
3. ‚úÖ **–£–≤–µ–¥–æ–º–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö —á–µ—Ä–µ–∑ Telegram
4. ‚úÖ **–°–æ—Ö—Ä–∞–Ω–∏—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ** –ø–µ—Ä–µ–¥ –æ—Å—Ç–∞–Ω–æ–≤–∫–æ–π
5. ‚úÖ **–î–∞—Å—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é** –æ –ø—Ä–∏—á–∏–Ω–µ –∏ –º–µ—Å—Ç–µ –æ—à–∏–±–∫–∏

---

## üîç –ù–ê–ô–î–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´ –ò –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### 1. ReversalPointsStrategyTrader.java

#### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ 1.1: RuntimeException –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
**–ë—ã–ª–æ:**
```java
try {
    this.init(...);
} catch (NoSuchSymbolException e) {
    throw new RuntimeException(e); // –ü–†–û–ì–†–ê–ú–ú–ê –í–´–õ–ï–¢–ò–¢
}
```

**–°—Ç–∞–ª–æ:**
```java
try {
    RetryPolicy.forApiCalls().executeVoid(() -> {
        this.init(...);
    }, "Trading initialization");
} catch (Exception e) {
    ErrorHandler.handleFatalError(e, "Trading Initialization", "...");
    return; // Graceful exit —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ–º
}
```

**–ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:**
- ‚úÖ Retry —Å 5 –ø–æ–ø—ã—Ç–∫–∞–º–∏ –∏ —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤ Telegram
- ‚úÖ Graceful shutdown –≤–º–µ—Å—Ç–æ –≤—ã–ª–µ—Ç–∞

---

#### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ 1.2: –ù–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ –æ—à–∏–±–æ–∫
**–ë—ã–ª–æ:**
```java
catch (NoSuchSymbolException | InsufficientAmountOfUsdtException e) {
    e.printStackTrace();
    ImageAndMessageSender.sendTelegramMessage("–û—à–∏–±–∫–∞: " + e.getMessage());
    persistState();
    // –ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç—É –±–µ–∑ –∞–Ω–∞–ª–∏–∑–∞
}
```

**–°—Ç–∞–ª–æ:**
```java
int consecutiveErrors = 0;
int maxConsecutiveErrors = 10;

catch (NoSuchSymbolException | InsufficientAmountOfUsdtException e) {
    consecutiveErrors++;
    ErrorHandler.handleError(e, "Trading Loop", "Processing trading logic", true);
    persistState();
    
    if (consecutiveErrors >= maxConsecutiveErrors) {
        ErrorHandler.handleFatalError(e, "Trading Loop", "Too many consecutive errors");
        break; // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ—Å–ª–µ 10 –æ—à–∏–±–æ–∫ –ø–æ–¥—Ä—è–¥
    }
    
    TimeUnit.SECONDS.sleep(30); // –ó–∞–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–¥ –ø–æ–≤—Ç–æ—Ä–æ–º
}
```

**–ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:**
- ‚úÖ –°—á—ë—Ç—á–∏–∫ consecutive errors
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ—Å–ª–µ 10 –æ—à–∏–±–æ–∫ –ø–æ–¥—Ä—è–¥
- ‚úÖ –ó–∞–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–¥ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø–æ–ø—ã—Ç–∫–æ–π
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

---

#### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ 1.3: NullPointerException –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è
**–ë—ã–ª–æ:**
```java
catch (NullPointerException e) {
    e.printStackTrace(); // –¢–æ–ª—å–∫–æ –ø–µ—á–∞—Ç–∞–µ—Ç—Å—è
    // –ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Å –ø–æ–≤—Ä–µ–∂–¥—ë–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
}
```

**–°—Ç–∞–ª–æ:**
```java
catch (NullPointerException e) {
    log.error("[Trader] Unexpected NullPointerException", e);
    ErrorHandler.handleError(e, "Trading Loop",
        "Null pointer - possible data corruption", true);
    persistState();
    consecutiveErrors++;
    
    if (consecutiveErrors >= 3) {
        ErrorHandler.handleFatalError(e, "Trading Loop",
            "Repeated NPE indicate data corruption");
        break; // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ—Å–ª–µ 3 NPE
    }
}
```

**–ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:**
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –≤–æ–∑–º–æ–∂–Ω–æ–π –∫–æ—Ä—Ä—É–ø—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –µ—Å–ª–∏ NPE –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è

---

#### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ 1.4: RuntimeException –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞
**–ë—ã–ª–æ:**
```java
try {
    Files.delete(Path.of(currentPicturePath));
} catch (IOException e) {
    throw new RuntimeException(e); // –í–´–õ–ï–¢ –∏–∑-–∑–∞ –º–µ–ª–æ—á–∏
}
```

**–°—Ç–∞–ª–æ:**
```java
try {
    Files.delete(Path.of(currentPicturePath));
} catch (IOException e) {
    log.warn("Failed to delete temporary file: {}", currentPicturePath);
    // –ù–ï –±—Ä–æ—Å–∞–µ–º –∏—Å–∫–ª—é—á–µ–Ω–∏–µ - —ç—Ç–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ
}
```

**–ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:**
- ‚úÖ –ü—Ä–æ–≥—Ä–∞–º–º–∞ –Ω–µ –≤—ã–ª–µ—Ç–∏—Ç –∏–∑-–∑–∞ –Ω–µ—É–¥–∞—á–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è
- ‚úÖ –¢–æ–ª—å–∫–æ warning –≤ –ª–æ–≥–∞—Ö

---

### 2. BinanceAccount.java

#### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ 2.1: –ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞
**–ë—ã–ª–æ:**
```java
while (!result) {
    try {
        // –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞
        result = true;
    } catch (Exception e) {
        TimeUnit.SECONDS.sleep(10);
        // –ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª, –º–æ–∂–µ—Ç –∑–∞–≤–∏—Å–Ω—É—Ç—å –Ω–∞–≤—Å–µ–≥–¥–∞
    }
}
```

**–°—Ç–∞–ª–æ:**
```java
int maxAttempts = 5;
int attempt = 0;
Exception lastError = null;

while (attempt < maxAttempts) {
    attempt++;
    try {
        // –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞
        return; // –£—Å–ø–µ—Ö
    } catch (Exception e) {
        lastError = e;
        log.error("Failed to create Binance client, attempt {}/{}", attempt, maxAttempts);
        
        if (attempt < maxAttempts) {
            TimeUnit.SECONDS.sleep(10);
        }
    }
}

// –í—Å–µ –ø–æ–ø—ã—Ç–∫–∏ –Ω–µ—É–¥–∞—á–Ω—ã - –¥–µ—Ç–∞–ª—å–Ω–∞—è –æ—à–∏–±–∫–∞
String fatalMessage = String.format(
    "üõë –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê\n\n" +
    "–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å Binance –∫–ª–∏–µ–Ω—Ç –ø–æ—Å–ª–µ %d –ø–æ–ø—ã—Ç–æ–∫\n" +
    "–ü—Ä–æ–≤–µ—Ä—å—Ç–µ API –∫–ª—é—á–∏ –∏ —Å–µ—Ç—å",
    maxAttempts
);
ImageAndMessageSender.sendTelegramMessage(fatalMessage);
throw new RuntimeException("Failed after " + maxAttempts + " attempts", lastError);
```

**–ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:**
- ‚úÖ –ú–∞–∫—Å–∏–º—É–º 5 –ø–æ–ø—ã—Ç–æ–∫ –≤–º–µ—Å—Ç–æ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ—Å—Ç–∏
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –ø—Ä–∏—á–∏–Ω–µ –æ—Ç–∫–∞–∑–∞
- ‚úÖ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—é –ø—Ä–æ–±–ª–µ–º—ã

---

#### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ 2.2: –ù–µ–∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ –æ—à–∏–±–∫–∏ buy/sell
**–ë—ã–ª–æ:**
```java
catch (BinanceClientException e) {
    System.err.println(String.format("fullErrMessage: %s", e.getMessage()));
    return null; // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∑–Ω–∞–µ—Ç —á—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ
}
```

**–°—Ç–∞–ª–æ:**
```java
catch (BinanceClientException e) {
    String errorMsg = String.format(
        "‚ùå –û—à–∏–±–∫–∞ –ø–æ–∫—É–ø–∫–∏ %s\n\n" +
        "–¢–∏–ø: BinanceClientException\n" +
        "–ö–æ–¥ –æ—à–∏–±–∫–∏: %d\n" +
        "HTTP —Å—Ç–∞—Ç—É—Å: %d\n" +
        "–°–æ–æ–±—â–µ–Ω–∏–µ: %s\n" +
        "–î–µ—Ç–∞–ª–∏: %s\n\n" +
        "–¶–µ–Ω–∞: %s\n" +
        "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: %s",
        coin.getName(),
        e.getErrorCode(),
        e.getHttpStatusCode(),
        e.getMessage(),
        e.getErrMsg(),
        price,
        adjustedQuantity
    );
    
    log.error("Buy order failed: {} (code: {}, http: {})", 
        e.getMessage(), e.getErrorCode(), e.getHttpStatusCode());
    
    ImageAndMessageSender.sendTelegramMessage(errorMsg);
    return null;
}
```

**–ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:**
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram
- ‚úÖ –ö–æ–¥ –æ—à–∏–±–∫–∏ –∏ HTTP —Å—Ç–∞—Ç—É—Å
- ‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–¥–µ–ª–∫–∏
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## üÜï –ù–û–í–´–ï –ö–û–ú–ü–û–ù–ï–ù–¢–´

### ErrorHandler.java

–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫ —Å —Ç—Ä–µ–º—è —É—Ä–æ–≤–Ω—è–º–∏:

#### 1. Warning (–ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Ä–∞–±–æ—Ç—É)
```java
ErrorHandler.handleWarning(e, "Chart Screenshot", "Creating chart image");
```
**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
- –ù–µ—É–¥–∞—á–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ç–æ
- –ù–µ—É–¥–∞—á–∞ —É–¥–∞–ª–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
- –ù–µ–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å–µ—Ç–µ–≤—ã–µ –æ—à–∏–±–∫–∏

**–ü–æ–≤–µ–¥–µ–Ω–∏–µ:**
- ‚ö†Ô∏è –û—Ç–ø—Ä–∞–≤–∫–∞ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –≤ Telegram
- üìù Warning –≤ –ª–æ–≥–∞—Ö
- ‚úÖ –ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç—É

---

#### 2. Error (–ø–æ–ø—ã—Ç–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è)
```java
boolean canRecover = ErrorHandler.handleError(e,
    "Trading Loop",
    "Processing trading logic",
    true);
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
- –û—à–∏–±–∫–∏ API
- –û—à–∏–±–∫–∏ –ø–æ–ª—É—á–µ–Ω–∏—è —Ü–µ–Ω—ã
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–µ—Ç–µ–≤—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

**–ü–æ–≤–µ–¥–µ–Ω–∏–µ:**
- ‚ùå –î–µ—Ç–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram
- üìç –ö–æ–Ω—Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏
- ‚öôÔ∏è –î–µ–π—Å—Ç–≤–∏–µ –∫–æ—Ç–æ—Ä–æ–µ –≤—ã–ø–æ–ª–Ω—è–ª–æ—Å—å
- üìÑ –ú–µ—Å—Ç–æ –≤ –∫–æ–¥–µ (–∫–ª–∞—Å—Å, –º–µ—Ç–æ–¥, —Å—Ç—Ä–æ–∫–∞)
- üîÑ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ñ–ª–∞–≥ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

**–ü—Ä–∏–º–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏—è:**
```
‚ùå –û–®–ò–ë–ö–ê

‚è∞ –í—Ä–µ–º—è: 2026-02-19 15:30:45
üìç –ö–æ–Ω—Ç–µ–∫—Å—Ç: Trading Loop
‚öôÔ∏è –î–µ–π—Å—Ç–≤–∏–µ: Processing trading logic for bitcoin

üí• –û—à–∏–±–∫–∞: Connection timeout
üìù –¢–∏–ø: SocketTimeoutException
üìÑ –ú–µ—Å—Ç–æ: BinanceAccount.buy():102

üîÑ –ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø—ã—Ç–∞–µ—Ç—Å—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è...
```

---

#### 3. Fatal Error (–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã)
```java
ErrorHandler.handleFatalError(e,
    "Trading Initialization",
    "Initializing trader for bitcoin");
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä–µ–π–¥–µ—Ä
- –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –æ—à–∏–±–æ–∫ –ø–æ–¥—Ä—è–¥
- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

**–ü–æ–≤–µ–¥–µ–Ω–∏–µ:**
- üõë –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram
- üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ –≤ —Ñ–∞–π–ª `logs/error_*.log`
- ‚õî Graceful shutdown
- üìä –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è

**–ü—Ä–∏–º–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏—è:**
```
üõë –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê

‚è∞ –í—Ä–µ–º—è: 2026-02-19 15:30:45
üìç –ö–æ–Ω—Ç–µ–∫—Å—Ç: Trading Initialization
‚öôÔ∏è –î–µ–π—Å—Ç–≤–∏–µ: Initializing trader for bitcoin

‚ùå –û—à–∏–±–∫–∞: Failed to connect to Binance API
üìù –¢–∏–ø: ConnectException
üìÑ –§–∞–π–ª: BinanceAccount.BinanceSpotTrader():58

‚õî –ü—Ä–æ–≥—Ä–∞–º–º–∞ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞.
–¢—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫.
```

---

### RetryPolicy.java

–ü–æ–ª–∏—Ç–∏–∫–∞ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π.

#### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
```java
// API –≤—ã–∑–æ–≤—ã (5 –ø–æ–ø—ã—Ç–æ–∫, –¥–æ 60—Å –∑–∞–¥–µ—Ä–∂–∫–∞)
RetryPolicy apiRetry = RetryPolicy.forApiCalls();
Double price = apiRetry.execute(() -> {
    return Account.getCurrentPrice(coin);
}, "Get current price");

// –°–µ—Ç–µ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (4 –ø–æ–ø—ã—Ç–∫–∏, –¥–æ 30—Å)
RetryPolicy netRetry = RetryPolicy.forNetworkOperations();

// –§–∞–π–ª–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (3 –ø–æ–ø—ã—Ç–∫–∏, –¥–æ 5—Å)
RetryPolicy fileRetry = RetryPolicy.forFileOperations();
```

#### –ê–ª–≥–æ—Ä–∏—Ç–º:
1. –ü–æ–ø—ã—Ç–∫–∞ 1: –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ
2. –ü–æ–ø—ã—Ç–∫–∞ 2: –∑–∞–¥–µ—Ä–∂–∫–∞ 2—Å
3. –ü–æ–ø—ã—Ç–∫–∞ 3: –∑–∞–¥–µ—Ä–∂–∫–∞ 4—Å
4. –ü–æ–ø—ã—Ç–∫–∞ 4: –∑–∞–¥–µ—Ä–∂–∫–∞ 8—Å
5. –ü–æ–ø—ã—Ç–∫–∞ 5: –∑–∞–¥–µ—Ä–∂–∫–∞ 16—Å (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ maxDelay)

#### –£–º–Ω–∞—è –ª–æ–≥–∏–∫–∞:
- ‚úÖ –ü–æ–≤—Ç–æ—Ä—è–µ—Ç —Ç–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏ (timeout, connection, network)
- ‚ùå –ù–µ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ (invalid parameter, insufficient funds)
- üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥–æ–π –ø–æ–ø—ã—Ç–∫–∏

---

## üìä –°–ò–°–¢–ï–ú–ê –ú–û–ù–ò–¢–û–†–ò–ù–ì–ê

### –°—á—ë—Ç—á–∏–∫ consecutive errors
```java
int consecutiveErrors = 0;
int maxConsecutiveErrors = 10;

// –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –æ—à–∏–±–∫–∏
consecutiveErrors++;

// –ü–æ—Å–ª–µ —É—Å–ø–µ—Ö–∞
consecutiveErrors = 0;

// –ü—Ä–æ–≤–µ—Ä–∫–∞
if (consecutiveErrors >= maxConsecutiveErrors) {
    ErrorHandler.handleFatalError(...);
    break;
}
```

**–ó–∞—á–µ–º:** –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª –æ—à–∏–±–æ–∫.

**–ü–æ—Ä–æ–≥–∏:**
- Trading loop: 10 –æ—à–∏–±–æ–∫ –ø–æ–¥—Ä—è–¥
- NullPointerException: 3 –æ—à–∏–±–∫–∏ –ø–æ–¥—Ä—è–¥
- Price fetching: 10 –æ—à–∏–±–æ–∫ –ø–æ–¥—Ä—è–¥

---

## üîÑ GRACEFUL SHUTDOWN

### –ü—Ä–∏ InterruptedException (Ctrl+C)
```java
catch (InterruptedException e) {
    log.info("[Trader] Trading interrupted - shutting down gracefully");
    persistState(); // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
    stateManager.shutdown(); // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
    
    ImageAndMessageSender.sendTelegramMessage(
        "üõë –¢–æ—Ä–≥–æ–≤–ª—è –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –ø–æ –∫–æ–º–∞–Ω–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è\n" +
        "–°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ."
    );
    
    Thread.currentThread().interrupt();
    return; // –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –≤—ã—Ö–æ–¥
}
```

### –ü—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–∫–∞—Ö
```java
// –í –∫–æ–Ω—Ü–µ –º–µ—Ç–æ–¥–∞ startTrading()
persistState();
stateManager.shutdown();

ImageAndMessageSender.sendTelegramMessage(
    "‚õî –¢–æ—Ä–≥–æ–≤–ª—è –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∏–∑-–∑–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫\n" +
    "–°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ. –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫."
);
```

---

## üìÅ –õ–û–ì–ò–†–û–í–ê–ù–ò–ï

### –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:
- **ERROR**: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏
- **WARN**: –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- **INFO**: –í–∞–∂–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è (—Å—Ç–∞—Ä—Ç/—Å—Ç–æ–ø, —Å–¥–µ–ª–∫–∏)
- **DEBUG**: –î–µ—Ç–∞–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### –ì–¥–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ª–æ–≥–∏:
```
logs/
‚îú‚îÄ‚îÄ trading.log                  # –û—Å–Ω–æ–≤–Ω–æ–π –ª–æ–≥
‚îú‚îÄ‚îÄ trading-2026-02-19.log       # –†–æ—Ç–∞—Ü–∏—è –ø–æ –¥–Ω—è–º
‚îú‚îÄ‚îÄ error_2026-02-19_15-30-45.log  # –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏
‚îî‚îÄ‚îÄ ...
```

### –§–æ—Ä–º–∞—Ç –ª–æ–≥–∞:
```
15:30:45 ERROR ErrorHandler - Error in Trading Loop: Connection timeout
  at BinanceAccount.buy(BinanceAccount.java:102)
  at ReversalPointsStrategyTrader.startResearchingChart(...)
```

---

## üéØ –ü–†–ò–ú–ï–†–´ –°–¶–ï–ù–ê–†–ò–ï–í

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –í—Ä–µ–º–µ–Ω–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ —Å —Å–µ—Ç—å—é
```
1. API –≤—ã–∑–æ–≤ –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç ‚Üí SocketTimeoutException
2. RetryPolicy –¥–µ–ª–∞–µ—Ç –ø–æ–ø—ã—Ç–∫—É 2 (–∑–∞–¥–µ—Ä–∂–∫–∞ 2—Å)
3. –£—Å–ø–µ—Ö ‚Üí —Ç–æ—Ä–≥–æ–≤–ª—è –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è
4. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç warning (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: Binance API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
```
1. 5 –ø–æ–ø—ã—Ç–æ–∫ –ø–æ–ª—É—á–∏—Ç—å —Ü–µ–Ω—É ‚Üí –≤—Å–µ –Ω–µ—É–¥–∞—á–Ω—ã
2. consecutiveErrors = 1
3. –ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç —ç—Ç–æ—Ç —Ç–∏–∫
4. –°–ª–µ–¥—É—é—â–∏–π —Ç–∏–∫: —É—Å–ø–µ—Ö ‚Üí consecutiveErrors = 0
5. –¢–æ—Ä–≥–æ–≤–ª—è –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: 10 –æ—à–∏–±–æ–∫ –ø–æ–¥—Ä—è–¥
```
1. consecutiveErrors –¥–æ—Å—Ç–∏–≥–∞–µ—Ç 10
2. ErrorHandler.handleFatalError() –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç:
   "üõë –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê
    ...
    ‚õî –ü—Ä–æ–≥—Ä–∞–º–º–∞ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞"
3. persistState() —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ
4. stateManager.shutdown()
5. –ü—Ä–æ–≥—Ä–∞–º–º–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∞–ª Ctrl+C
```
1. InterruptedException
2. –°–æ–æ–±—â–µ–Ω–∏–µ: "üõë –¢–æ—Ä–≥–æ–≤–ª—è –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –ø–æ –∫–æ–º–∞–Ω–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"
3. persistState() ‚Üí —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ
4. stateManager.shutdown()
5. Graceful exit
```

---

## ‚úÖ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏—Å—Ç–µ–º—É –æ—à–∏–±–æ–∫:

#### –¢–µ—Å—Ç 1: –í—Ä–µ–º–µ–Ω–Ω–∞—è —Å–µ—Ç–µ–≤–∞—è –æ—à–∏–±–∫–∞
```bash
# –í–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã –æ—Ç–∫–ª—é—á–∏—Ç–µ WiFi –Ω–∞ 10 —Å–µ–∫—É–Ω–¥
# –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:
# - –ù–µ—Å–∫–æ–ª—å–∫–æ retry –ø–æ–ø—ã—Ç–æ–∫
# - Warning —Å–æ–æ–±—â–µ–Ω–∏—è –≤ Telegram
# - –ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç—É –ø–æ—Å–ª–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–≤—è–∑–∏
```

#### –¢–µ—Å—Ç 2: –ù–µ–≤–µ—Ä–Ω—ã–µ API –∫–ª—é—á–∏
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å –Ω–µ–≤–µ—Ä–Ω—ã–º–∏ –∫–ª—é—á–∞–º–∏ Binance
# –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:
# - 5 –ø–æ–ø—ã—Ç–æ–∫ —Å–æ–∑–¥–∞—Ç—å –∫–ª–∏–µ–Ω—Ç
# - –°–æ–æ–±—â–µ–Ω–∏–µ: "–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å Binance –∫–ª–∏–µ–Ω—Ç"
# - –ü—Ä–æ–≥—Ä–∞–º–º–∞ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è (fatal error)
```

#### –¢–µ—Å—Ç 3: Graceful shutdown
```bash
# –í–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –Ω–∞–∂–º–∏—Ç–µ Ctrl+C
# –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:
# - –°–æ–æ–±—â–µ–Ω–∏–µ: "–¢–æ—Ä–≥–æ–≤–ª—è –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –ø–æ –∫–æ–º–∞–Ω–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"
# - –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ
# - –ü—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
```

---

## üìã –ß–ï–ö–õ–ò–°–¢ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

### ReversalPointsStrategyTrader.java
- [x] –£–±—Ä–∞–Ω—ã –≤—Å–µ `throw new RuntimeException`
- [x] –î–æ–±–∞–≤–ª–µ–Ω —Å—á—ë—Ç—á–∏–∫ consecutive errors
- [x] Retry –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
- [x] Retry –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ü–µ–Ω—ã
- [x] Graceful shutdown –ø—Ä–∏ InterruptedException
- [x] –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
- [x] –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- [x] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

### BinanceAccount.java
- [x] –£–±—Ä–∞–Ω –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞
- [x] –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ 5 –ø–æ–ø—ã—Ç–æ–∫
- [x] –î–µ—Ç–∞–ª—å–Ω—ã–µ –æ—à–∏–±–∫–∏ buy/sell –≤ Telegram
- [x] –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- [x] Fatal error message –ø—Ä–∏ –Ω–µ—É–¥–∞—á–µ

### –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã
- [x] ErrorHandler.java - —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
- [x] RetryPolicy.java - –ø–æ–ª–∏—Ç–∏–∫–∞ –ø–æ–≤—Ç–æ—Ä–æ–≤
- [x] ERROR_HANDLING_REPORT.md - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

---

## üöÄ –†–ê–ó–í–Å–†–¢–´–í–ê–ù–ò–ï

### 1. Pull –∏–∑–º–µ–Ω–µ–Ω–∏–π
```bash
cd /path/to/CryptoCombainerClaude
git pull origin master
```

### 2. Reload Maven –≤ IntelliJ
```
–ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å "Maven" ‚Üí –∏–∫–æ–Ω–∫–∞ üîÑ "Reload All Maven Projects"
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
```bash
mvn clean compile
```

### 4. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–æ–≥—Ä–∞–º–º—ã
```bash
# –ù–∞ Kubuntu systemd
sudo systemctl restart cryptotrader.service

# –ò–ª–∏ –≤ IntelliJ
Run ‚Üí App.java
```

---

## üîç –ú–û–ù–ò–¢–û–†–ò–ù–ì –ü–û–°–õ–ï –†–ê–ó–í–Å–†–¢–´–í–ê–ù–ò–Ø

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏:
```bash
# –°–∏—Å—Ç–µ–º–Ω—ã–µ –ª–æ–≥–∏
tail -f /opt/cryptotrader/logs/app-$(date +%Y%m%d).log

# –û—à–∏–±–∫–∏
tail -f /opt/cryptotrader/logs/trading.log | grep ERROR

# –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
tail -f /opt/cryptotrader/logs/trading.log | grep WARN
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Telegram:
- –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ: "üÜï –ù–æ–≤–∞—è —Ç–æ—Ä–≥–æ–≤–∞—è —Å–µ—Å—Å–∏—è"
- –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö: –î–µ—Ç–∞–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å üìçüìÑ‚öôÔ∏è
- –ü—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ: "üõë –¢–æ—Ä–≥–æ–≤–ª—è –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞"

---

## üìû –ü–û–î–î–ï–†–ñ–ö–ê

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏** –≤ `logs/trading.log`
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ Telegram** –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª—ã –æ—à–∏–±–æ–∫** –≤ `logs/error_*.log`
4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ** –≤ `trading_states/`

---

*–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞: —Ñ–µ–≤—Ä–∞–ª—å 2026*
*–í–µ—Ä—Å–∏—è —Å–∏—Å—Ç–µ–º—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫: 1.0*
*–°—Ç–∞—Ç—É—Å: Production Ready ‚úÖ*
